name: Repo Inspector PR

on:
  workflow_dispatch:
  pull_request:
    paths:
      - '**/*'

jobs:
  inspect:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Run repo-inspector (generate suggestions)
        run: |
          node scripts/repo-inspector.cjs
      - name: Create PR with fixes (optional)
        if: github.event_name == 'workflow_dispatch'
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: 'chore(repo-inspector): apply conservative fixes'
          title: 'repo-inspector: conservative fixes'
          body: |
            This PR applies conservative fixes suggested by `scripts/repo-inspector.cjs`.
          labels: 'auto-generated'
          base: ${{ github.ref }}
          path: .
